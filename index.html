<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Babylon.js Model Viewer</title>
  <style>
    html, body {
      overflow: hidden;
      width: 100%;
      height: 100%;
      margin: 0;
      padding: 0;
      font-family: sans-serif;
    }

    canvas {
      width: 100%;
      height: 100%;
      touch-action: none;
      display: block;
    }

    #meshMenu {
      position: fixed;
      top: 80px;
      right: 0;
      width: 250px;
      max-height: 80vh;
      overflow-y: auto;
      background: rgba(255, 255, 255, 0.95);
      box-shadow: -2px 0 6px rgba(0, 0, 0, 0.2);
      padding: 10px;
      z-index: 999;
      font-size: 14px;
    }

    #meshMenu h3 {
      margin-top: 0;
      font-weight: 600;
      font-size: 16px;
    }

    #meshMenu ul {
      list-style: none;
      padding-left: 0;
      margin: 0;
    }

    #meshMenu li {
      cursor: pointer;
      padding: 5px;
      border-radius: 4px;
      transition: background 0.3s;
    }

    #meshMenu li:hover {
      background-color: #eee;
    }
  </style>
</head>
<body>
  <div id="meshMenu"></div>
  <canvas id="renderCanvas"></canvas>

  <!-- Babylon.js -->
  <script src="https://cdn.babylonjs.com/babylon.js"></script>
  <script src="https://cdn.babylonjs.com/loaders/babylonjs.loaders.min.js"></script>

  <script>
    const canvas = document.getElementById("renderCanvas");
    const engine = new BABYLON.Engine(canvas, true);
    const scene = new BABYLON.Scene(engine);

    // Cámara orbital
    const camera = new BABYLON.ArcRotateCamera("Camera", Math.PI / 2, Math.PI / 2.5, 10, BABYLON.Vector3.Zero(), scene);
    camera.attachControl(canvas, true);

    // Luz
    const light = new BABYLON.HemisphericLight("light", new BABYLON.Vector3(1, 1, 0), scene);
    light.intensity = 0.8;

    // Material blanco
    const whiteMaterial = new BABYLON.StandardMaterial("whiteMat", scene);
    whiteMaterial.diffuseColor = new BABYLON.Color3(1, 1, 1);

    // Cargar modelo GLB
    BABYLON.SceneLoader.Append("./", "modelo.glb", scene, () => {
      scene.createDefaultCameraOrLight(true, true, true);

      // Crear menú
      const meshMenu = document.getElementById("meshMenu");
      meshMenu.innerHTML = "<h3>Model Parts</h3><ul></ul>";
      const ul = meshMenu.querySelector("ul");

      scene.meshes.forEach(mesh => {
        if (mesh.name && mesh.isVisible && mesh.name !== "__root__") {
          mesh.material = whiteMaterial;

          const li = document.createElement("li");
          li.textContent = mesh.name;
          li.onclick = () => {
            const box = mesh.getBoundingInfo().boundingBox;
            const target = box.centerWorld;
            camera.setTarget(target);
            camera.radius = box.extendSizeWorld.length() * 3;
          };

          ul.appendChild(li);
        }
      });
    });

    engine.runRenderLoop(() => {
      scene.render();
    });

    window.addEventListener("resize", () => {
      engine.resize();
    });
  </script>
</body>
</html>
